version: 2

unit_tests:
  - name: test_excel_financial_functions_pmt
    model: test_excel_financial_functions
    given:
      - input: ref('seed_test_excel_financial_functions')
          
    expect:
      rows:
        - {
            pmt: -100.00,
            cumipmt: null,
            cumprinc: null,
          }
        - {
            pmt: -297.47,
            cumipmt: -20.42,
            cumprinc: -277.05,
          }
        - {
            pmt: -532.94,
            cumipmt: -489.75,
            cumprinc: -5372.62,
          }
        - {
            pmt: -221.60,
            cumipmt: -318.47,
            cumprinc: -5000.00,
          }
        - {
            pmt: -393.72,
            cumipmt: -3623.42,
            cumprinc: -20000.00,
          }
      
models:
  - name: test_excel_financial_functions
    columns:
      - name: rate
        data_type: float64
        data_tests:
          - not_null
      - name: nper
        data_type: int64
        data_tests:
          - not_null
      - name: pv
        data_type: float64
        data_tests:
          - not_null
      - name: type
        data_type: int64
        data_tests:
          - not_null
      - name: pmt
        data_type: float64
        data_tests:
          - not_null
      - name: cumipmt
        data_type: float64
        data_tests:
          - not_null
      - name: cumprinc
        data_type: float64
        data_tests:
          - not_null                    